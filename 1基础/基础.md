# Learn Nodejs

## 1. 基础

### 1.1 什么是nodejs

nodejs 是和 JavaScript 具有相同的语言风格，但是功能不同的两种语言，也可以说 nodejs 只是 JavaScript 的一种运行环境，(JavaScript 是一种脚本语言，而脚本语言就需要一个解析器)，当JavaScript运行在浏览器中，浏览器就是JavaScript的解析器(浏览器并不是直接解析js文件，而是通过html文件)，如果需要js文件独立运行，就需要nodejs了，这时node就是js的解析器；

每一个解析器（运行环境），允许js使用其提供的内置对象或者方法，去做一些事情，例如：浏览器（DOM操作）提供的document对象。在 nodejs 中提供的就是 fs || http 等

### 1.2 nodejs 和 JavaScript

JavaScript 只不过是 nodejs 的作者为了实现其思想，选择的一种编程语言；

相同：都是基于ECMA语法
例如在node中：
```
    var a = 100;
    console.log(a)
    // 100

    var b = new Date();
    console.log(b)
    //Mon Dec 26 2016 01:49:53 GMT+0800 (中国标准时间)

    var c = [1,2,3,4]
    c.push(5);
    console.log(c)
    // [ 1, 2, 3, 4, 5 ]

    function Person (name) {
        this.name = name
    }
    Person.prototype.say = function(){
        console.log(this.name)
    };

    var p1 = new Person('person');
    p1.say();
    // person
```

不同：
1. js中的顶层对象是window，但是node中没有window，其顶层对象是global；（在js中也存在global，但是不允许访问）
2. 在js 中，通过在通过 var 声明的变量是挂在window对象上的，但是在node中，通过var声明的对象，仅仅是在其模块作用域中（一个模块就是一个作用域）

例如：
```
var a = 100;
console.log(a) // 100
console.log(global.a) // undefined


global.a = 200;
console.log(global.a) // 200
```


### 1.3 配置nodejs

下载地址： https://nodejs.org/en/download/

建议下载.msi 的版本，提供的npm等。

配置编辑器：

1）sublime:

在sublime 中安装 nodejs插件，然后按照 

http://www.cnblogs.com/qiaojie/p/5560388.html

的方式，进行修改；
如果需要使用node编译，ctrl + B,

2）WS

webStorm: 
默认配置，右键运行

### 1.4 运行

1》运行 nodejs 或者 win+r 输入node 
2》命令行： win+r 加 cmd 输入 node， 退出 使用两次 ctrl + c

常用命令行： 
cls -- 清屏
cd -- 路径
dir -- 目录

node -v 查看版本

运行文件，通过 node 路径 就可以运行
例如：node D:\soft\wamp\www\GitHub\learnNode\1基础\html\1node.js 

3》 编辑器中运行


## 2. node 模块加载系统

使用 require 方法， 在一个模块中加载另一个模块；

`require('address')`
address --- 相对路径 || 绝对路径

>注：
路径：必须以 ‘./路径’ 的格式引入，如果没有 ‘./’ 就会指向node核心模块，或者去加载node目录下的 node_modules 文件夹内部的文件

### 2.1 模块的查找加载机制

当需要查找一个文件的时候，node内部会遵循一定的方式去查找，以require('./2')为例

>1. 查找文件名称为2的文件
2. 查找2.js文件
3. 查找2.json文件
4. 查找2.node文件
5. 报错

一旦查找到文件，就直接结束查找，并返回

### 2.2 module 和 exports 模块

在node中一个模块就是一个作用域，如果模块1 想直接访问 模块2 的内容，是访问不到的；

解决方法：
1. 使用将变量挂在顶层对象 global 下。
不建议使用，会增加全局变量

2. 使用 module 模块对象 --- module是局部对象
在 module 中保存着当前模块的信息

例如：
```
console.log(module)
```

输出：
```
Module {
id: '.',
exports: {},
parent: null,
filename: 'D:\\soft\\wamp\\www\\GitHub\\learnNode\\1基础\\html\\5module.js',
loaded: false,
children: [],
paths: 
[ 'D:\\soft\\wamp\\www\\GitHub\\learnNode\\1基础\\html\\node_modules',
 'D:\\soft\\wamp\\www\\GitHub\\learnNode\\1基础\\node_modules',
 'D:\\soft\\wamp\\www\\GitHub\\learnNode\\node_modules',
 'D:\\soft\\wamp\\www\\GitHub\\node_modules',
 'D:\\soft\\wamp\\www\\node_modules',
 'D:\\soft\\wamp\\node_modules',
 'D:\\soft\\node_modules',
 'D:\\node_modules' ] }
```

可以将提供给外部去访问的元素，挂在module.exports下
例如：
```
console.log(module)
var a = 100;
module.exports.a = 100;
console.log(module)
```

输出：
```
Module {
  id: '.',
  exports: { a: 100 },
  parent: null,
  filename: 'D:\\soft\\wamp\\www\\GitHub\\learnNode\\1基础\\html\\5module.js',
  loaded: false,
  children: [],
  paths: 
   [ 'D:\\soft\\wamp\\www\\GitHub\\learnNode\\1基础\\html\\node_modules',
     'D:\\soft\\wamp\\www\\GitHub\\learnNode\\1基础\\node_modules',
     'D:\\soft\\wamp\\www\\GitHub\\learnNode\\node_modules',
     'D:\\soft\\wamp\\www\\GitHub\\node_modules',
     'D:\\soft\\wamp\\www\\node_modules',
     'D:\\soft\\wamp\\node_modules',
     'D:\\soft\\node_modules',
     'D:\\node_modules' ] }
```

在局部模块中还存在属性--exports
exports === module.exports

所以exports.a = 100 和 module.exports.a = 100 是相同的

注：
不建议修改 module.exports ,如果修改了module.exports 就将破坏exports和module.exports的关联，对exports一样；

## 3. nodeAPI

### 3.1 global对象

属性：
1）__filename -- 表示编译后的绝对路径
2）__dirname -- 表示编译后的模块所在文件夹的绝对路径
3）ECMA对象

示例：
```
console.log(__filename)
// D:\soft\wamp\www\GitHub\learnNode\1基础\html\7global.js
console.log(__dirname)
// D:\soft\wamp\www\GitHub\learnNode\1基础\html
```

注： __filename 和 __dirname 都是属于模块的
